services:
  native-tauri:
    build:
      context: ./
      dockerfile: dev.Dockerfile
    volumes:
      - ./src:/opt/metro/src:rw
      - ./src-tauri:/opt/metro/src-tauri:rw
      - /tmp/.X11-unix:/tmp/.X11-unix:rw
      - ${HOME}/.Xauthority:/home/developer/.Xauthority:rw
    environment:
      RUST_LOG: debug # Syntax: https://docs.rs/tracing-subscriber/latest/tracing_subscriber/filter/struct.EnvFilter.html#example-syntax
      # For GUI
      DISPLAY: ${DISPLAY}
      WAYLAND_DISPLAY: ${WAYLAND_DISPLAY}
      XDG_RUNTIME_DIR: ${XDG_RUNTIME_DIR}
      PULSE_SERVER: ${PULSE_SERVER}
      RUST_BACKTRACE: ${RUST_BACKTRACE}
    # Optional but recommended for GUI apps
    devices:
      - /dev/dri:/dev/dri
    security_opt:
      - seccomp:unconfined
    network_mode: host